(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"BXu+":function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,".event-cover[data-v-8a9924aa]{background-size:cover;background-position:50%;background-repeat:no-repeat}.modal-cover-header[data-v-8a9924aa]{display:flex;align-items:center;justify-content:center}",""])},rxNm:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return a}));var n=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/jpeg";return new Promise((function(e,a){var o=document.createElement("img");o.onload=function(){var t,a=document.createElement("canvas");t=this.height>this.width?this.width:this.height,a.width=t,a.height=t;var s=0,c=0;this.width>this.height?s=-(this.width-this.height)/2:this.width<this.height&&(c=-(this.height-this.width)/2),a.getContext("2d").drawImage(this,s,c);var d=a.toDataURL(n,i);a.remove(),o.remove(),e(r(d))},o.onerror=function(){canvas.remove(),o.remove(),a(this)},o.src=t}))},a=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/jpeg";return new Promise((function(o,s){var c=document.createElement("img");c.onload=function(){var t=document.createElement("canvas");i||(i=this.height),e||(e=this.width);var s=Math.max(e/this.width,i/this.height);t.width=e,t.height=i;var d=0,l=0;e<i?d=-Math.abs(e-this.width)/4:e>i&&(l=-Math.abs(i-this.height)/4);var v=t.getContext("2d");v.scale(s,s),v.drawImage(this,d,l);var h=t.toDataURL(a,n);t.remove(),c.remove(),o(r(h))},c.onerror=function(){canvas.remove(),c.remove(),s(this)},c.src=t}))},r=function(t){var e=null,i=null,n=null;if(-1===t.indexOf(";base64,"))return i=(e=t.split(","))[0].split(":")[1],n=e[1],new Blob([n],{type:i});i=(e=t.split(";base64,"))[0].split(":")[1];for(var a=(n=window.atob(e[1])).length,r=new Uint8Array(a),o=0;o<a;++o)r[o]=n.charCodeAt(o);return new Blob([r],{type:i})}},ryWe:function(t,e,i){"use strict";i.r(e);var n=i("o0o1"),a=i.n(n),r=i("rxNm");function o(t,e,i,n,a,r,o){try{var s=t[r](o),c=s.value}catch(t){return void i(t)}s.done?e(c):Promise.resolve(c).then(n,a)}var s,c,d={name:"ModalCreateUpdateEvent",props:{onClose:Function,event_id:Number,crew_id:Number,classic_editor:Function,callback:Function},data:function(){return{editorConfig:{},cover:null,coverSrc:"/storage/event/default-cover.jpg",name:"",description:"<p>Content of the editor.</p>",errors:{},submitting:!1,deletting:!1}},mounted:function(){var t=this;$(this.$el).modal(),$(this.$el).on("hidden.bs.modal",(function(){t.$props.callback&&t.$props.callback(),t.$props.onClose()})),this.$props.event_id&&axios.get("/api/event/"+this.$props.event_id).then((function(e){t.coverSrc=e.data.data.cover,t.name=e.data.data.name,t.description=e.data.data.description}))},methods:{inputCover:(s=a.a.mark((function t(e,i){var n,o=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.cover=e,t.next=3,Object(r.a)(URL.createObjectURL(e.file),2400,900);case 3:this.cover.file=t.sent,this.coverSrc=URL.createObjectURL(e.file),this.$props.event_id&&((n=new FormData).append("cover",e.file),axios.post("/api/event/"+this.$props.event_id+"/cover/",n).then((function(t){o.coverSrc=t.data.cover})).catch((function(t){toastr.error(t.response.data)})));case 6:case"end":return t.stop()}}),t,this)})),c=function(){var t=this,e=arguments;return new Promise((function(i,n){var a=s.apply(t,e);function r(t){o(a,i,n,r,c,"next",t)}function c(t){o(a,i,n,r,c,"throw",t)}r(void 0)}))},function(t,e){return c.apply(this,arguments)}),submit:function(){var t=this;if(this.$props.event_id)axios.post("/api/event/"+this.$props.event_id,{name:this.name,description:this.description}).then((function(e){t.errors={},$(t.$el).modal("hide"),toastr.success("Event enregistré")})).catch((function(e){var i,n;(null==e||null===(i=e.response)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.errors)&&(t.errors=e.response.data.errors)}));else{var e,i=new FormData;i.append("cover",(null===(e=this.cover)||void 0===e?void 0:e.file)?this.cover.file:""),i.append("name",this.name),i.append("description",this.description),axios.post("/api/crew/"+this.$props.crew_id+"/event/",i).then((function(e){t.errors={},$(t.$el).modal("hide"),toastr.success("Event enregistré")})).catch((function(e){var i,n;(null==e||null===(i=e.response)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.errors)&&(t.errors=e.response.data.errors)}))}},deleteEvent:function(){var t=this;this.$props.event_id&&axios.delete("/api/event/"+this.$props.event_id).then((function(e){$(t.$el).modal("hide"),toastr.success("Event supprimé")})).catch((function(t){toastr.error("Une erreur est survenue")}))}}},l=(i("vhRe"),i("KHd+")),v=Object(l.a)(d,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"modal",attrs:{tabindex:"-1",role:"dialog"}},[i("div",{staticClass:"modal-dialog modal-dialog-centered modal-lg",attrs:{role:"document"}},[i("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),i("div",{staticClass:"modal-cover-header"},[i("file-upload",{attrs:{"input-id":"event-cover",accept:"image/*","min-height":150},on:{"input-file":t.inputCover}},[i("img",{staticClass:"event-cover",attrs:{src:t.coverSrc,height:"300",alt:"event cover"}})])],1),t._v(" "),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"container"},[i("div",{staticClass:"row"},[i("div",{staticClass:"offset-3 col-6"},[i("label",{attrs:{for:"crew-name"}},[t._v("Nom")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-control",attrs:{id:"crew-name",type:"text"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})])]),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-12"},[i("label",[t._v("Description")]),t._v(" "),i("ckeditor",{attrs:{editor:t.classic_editor,config:t.editorConfig},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1)])])]),t._v(" "),i("div",{staticClass:"modal-footer"},[t.$props.event_id?i("loading-button",{staticClass:"btn btn-danger",attrs:{type:"button",loading:t.deletting,on_click:t.deleteEvent}},[t._v("\n                    Supprimer\n                ")]):t._e(),t._v(" "),i("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("\n                    Fermer\n                ")]),t._v(" "),i("loading-button",{staticClass:"btn btn-primary",attrs:{type:"button",loading:t.submitting,on_click:t.submit}},[t._v("\n                    Enregistrer\n                ")])],1)])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title"},[this._v("Créer un Event")]),this._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])])}],!1,null,"8a9924aa",null);e.default=v.exports},vhRe:function(t,e,i){"use strict";i("x50+")},"x50+":function(t,e,i){var n=i("BXu+");"string"==typeof n&&(n=[[t.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(n,a);n.locals&&(t.exports=n.locals)}}]);